<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>Sistema de Videovigilancia from Scratch</title>
    <meta name="description" content="">
    <meta name="author" content="Jesús Torres">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- Le HTML5 shim, for IE6-8 support of HTML elements -->
    <!--[if lt IE 9]>
    <script src="./theme/html5.js"></script>
    <![endif]-->

    <!-- Le styles -->
    <link href="./theme/bootstrap.min.css" rel="stylesheet">
    <link href="./theme/bootstrap.min.responsive.css" rel="stylesheet">
    <link href="./theme/local.css" rel="stylesheet">
    <link href="./theme/pygments.css" rel="stylesheet">

</head>

<body>

<div class="navbar">
    <div class="navbar-inner">
    <div class="container">

         <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
             <span class="icon-bar"></span>
             <span class="icon-bar"></span>
             <span class="icon-bar"></span>
         </a>

        <a class="brand" href=".">Sistema de Videovigilancia from Scratch</a>

        <div class="nav-collapse">
        <ul class="nav">
                    
                            <li><a href="./pages/acerca-de.html">Acerca de...</a></li>
                        </ul>
        </div>
        
    </div>
    </div>
</div>

<div class="container">
    <div class="content">
    <div class="row">

        <div class="span9">
                

        


    <div class='article'>
        <div class="content-title">
            <a href="./como-usar-qmovie-en-qt.html"><h1>Como usar QMovie en Qt</h1></a>
            mié 13 febrero 2013

by <a class="url fn" href="./author/jesus-torres.html" rel="author">Jesús Torres</a>
 


 
        </div>
        
        <div><p><a href="./proyecto-qt-framework-de-desarrollo-de-aplicaciones.html" title="Proyecto Qt">Qt</a> trae una clase denominada <a href="http://qt-project.org/doc/qt-5.0/qtgui/qmovie.html" title="QMovie">QMovie</a> que facilita mostrar pequeñas
animaciones sin mucho esfuerzo.</p>
<p><a href="http://qt-project.org/doc/qt-5.0/qtgui/qmovie.html" title="QMovie">QMovie</a> está diseñada para ser independiente del formato de archivo pero como
internamente depende de <a href="http://qt-project.org/doc/qt-5.0/qtgui/qimagereader.html" title="QImageReader">QImageReader</a>, sólo puede utilizarse con los que esta
última soporta (véase <a href="http://qt-project.org/doc/qt-5.0/qtgui/qmovie.html" title="QMovie">QMovie</a>::<a href="http://qt-project.org/doc/qt-5.0/qtgui/qmovie.html#supportedFormats" title="QMovie::supportedFormats()">supportedFormats</a>()). Esto incluye GIF
animados, archivos MNG y MJPEG. Para mostrar vídeo y otros contenidos
multimedia, es mejor utilizar el <em>framework</em> <a href="http://qt-project.org/doc/qt-5.0/qtmultimedia/multimediaoverview.html" title="Qt Multimedia">Qt Multimedia</a>.</p>
<h2>Primeros pasos</h2>
<p>La forma más sencilla de usar <a href="http://qt-project.org/doc/qt-5.0/qtgui/qmovie.html" title="QMovie">QMovie</a> es asignar un objeto <a href="http://qt-project.org/doc/qt-5.0/qtgui/qmovie.html" title="QMovie">QMovie</a> a un
control <a href="http://qt-project.org/doc/qt-5.0/qtwidgets/qlabel.html" title="QLabel">QLabel</a> usando el método <a href="http://qt-project.org/doc/qt-5.0/qtwidgets/qlabel.html" title="QLabel">QLabel</a>::<a href="http://qt-project.org/doc/qt-5.0/qtwidgets/qlabel.html#setMovie" title="QLabel::setMovie()">setMovie</a>():</p>
<div class="codehilite"><pre><span class="n">QMovie</span> <span class="o">*</span><span class="n">movie</span> <span class="o">=</span> <span class="k">new</span> <span class="n">QMovie</span><span class="p">(</span><span class="s">&quot;video.mjpeg&quot;</span><span class="p">);</span>
<span class="n">ui</span><span class="o">-&gt;</span><span class="n">label</span><span class="o">-&gt;</span><span class="n">setMovie</span><span class="p">(</span><span class="n">movie</span><span class="p">);</span>
</pre></div>


<p>donde <code>ui</code> es el miembro de la clase que tiene asignada la instancia de la
ventana creada previamente con Qt Creator.</p>
<h2>Nombre de archivo especificado por el usuario</h2>
<p>No siempre ocurre que el nombre del archivo a reproducir se conozca de antemano
al desarrollar el programar. Si por ejemplo se pretende que el usuario lo
escoja de entre los disponibles en su disco duro podemos:</p>
<ol>
<li>
<p>Crear un objeto <a href="http://qt-project.org/doc/qt-5.0/qtgui/qmovie.html" title="QMovie">QMovie</a>, guardarlo en un miembro de la clase (manteniendo
 así un puntero al mismo que nos permita referenciarlo más adelante<sup id="fnref:1"><a class="footnote-ref" href="#fn:1" rel="footnote">1</a></sup>) y asignar
 dicho objeto <a href="http://qt-project.org/doc/qt-5.0/qtgui/qmovie.html" title="QMovie">QMovie</a> a <a href="http://qt-project.org/doc/qt-5.0/qtwidgets/qlabel.html" title="QLabel">QLabel</a>:</p>
<div class="codehilite"><pre><span class="nn">MovieViewerWindow::</span><span class="n">MovieViewerWindow</span><span class="p">(</span><span class="n">QWidget</span> <span class="o">*</span><span class="n">parent</span><span class="p">)</span>
    <span class="p">:</span> <span class="n">QMainWindow</span><span class="p">(</span><span class="n">parent</span><span class="p">),</span>
      <span class="n">ui</span><span class="p">(</span><span class="k">new</span> <span class="nn">Ui::</span><span class="n">MovieViewerWindow</span><span class="p">)</span>
<span class="p">{</span>
    <span class="sr">//</span> <span class="n">Aqu</span><span class="err">í</span> <span class="n">otro</span> <span class="n">c</span><span class="err">ó</span><span class="n">digo</span> <span class="n">de</span> <span class="n">inicializaci</span><span class="err">ó</span><span class="n">n</span> <span class="n">de</span> <span class="n">la</span> <span class="n">instancia</span><span class="o">...</span>

    <span class="n">movie_</span> <span class="o">=</span> <span class="k">new</span> <span class="n">QMovie</span><span class="p">(</span><span class="s">&quot;video.mjpeg&quot;</span><span class="p">);</span>
    <span class="n">ui</span><span class="o">-&gt;</span><span class="n">label</span><span class="o">-&gt;</span><span class="n">setMovie</span><span class="p">(</span><span class="n">movie_</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>


</li>
<li>
<p>En el slot de la acción que abre el cuadro de diálogo <em>abrir archivo</em>,
 asignar al objeto <a href="http://qt-project.org/doc/qt-5.0/qtgui/qmovie.html" title="QMovie">QMovie</a> el nombre escogido por el usuario mediante el
 método <a href="http://qt-project.org/doc/qt-5.0/qtgui/qmovie.html" title="QMovie">QMovie</a>::<a href="http://qt-project.org/doc/qt-5.0/qtgui/qmovie.html#setFileName" title="QMovie::setFileName()">setFileName</a>():</p>
<div class="codehilite"><pre><span class="n">void</span> <span class="nn">MovieViewerWindow::</span><span class="n">on_actionOpen_triggered</span><span class="p">()</span>
<span class="p">{</span>
    <span class="sr">//</span> <span class="n">Aqu</span><span class="err">í</span> <span class="n">el</span> <span class="n">c</span><span class="err">ó</span><span class="n">digo</span> <span class="n">que</span> <span class="n">abre</span> <span class="n">el</span> <span class="n">cuadro</span> <span class="n">de</span> <span class="n">di</span><span class="err">á</span><span class="n">logo</span> <span class="n">y</span> <span class="n">comprueba</span> <span class="n">si</span>
    <span class="sr">//</span> <span class="n">el</span> <span class="n">usuario</span> <span class="n">seleccion</span><span class="err">ó</span> <span class="n">alg</span><span class="err">ú</span><span class="n">n</span> <span class="n">archivo</span><span class="o">...</span>
    <span class="sr">//</span>
    <span class="sr">//</span> <span class="n">QString</span> <span class="n">fileName</span> <span class="o">=</span> <span class="nn">QFileDialog::</span><span class="n">getFileName</span><span class="p">(</span><span class="o">...</span><span class="p">);</span>
    <span class="sr">//</span>
    <span class="sr">//</span> <span class="o">...</span>
    <span class="sr">//</span>

    <span class="n">movie_</span><span class="o">-&gt;</span><span class="n">setFileName</span><span class="p">(</span><span class="n">fileName</span><span class="p">);</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">movie_</span><span class="o">-&gt;</span><span class="n">isValid</span><span class="p">())</span> <span class="p">{</span>
        <span class="nn">QMessageBox::</span><span class="n">critical</span><span class="p">(</span><span class="n">this</span><span class="p">,</span> <span class="nb">tr</span><span class="p">(</span><span class="s">&quot;Error&quot;</span><span class="p">),</span>
            <span class="nb">tr</span><span class="p">(</span><span class="s">&quot;No se pudo abrir el archivo o el formato es inválido&quot;</span><span class="p">));</span>
        <span class="k">return</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="n">movie_</span><span class="o">-&gt;</span><span class="n">start</span><span class="p">();</span>    <span class="sr">//</span> <span class="n">Iniciar</span> <span class="n">la</span> <span class="n">reproducci</span><span class="err">ó</span><span class="n">n</span> <span class="n">del</span> <span class="n">v</span><span class="err">í</span><span class="n">deo</span>
<span class="p">}</span>
</pre></div>


<p>Como se puede observar es conveniente utilizar el método <a href="http://qt-project.org/doc/qt-5.0/qtgui/qmovie.html" title="QMovie">QMovie</a>::<a href="http://qt-project.org/doc/qt-5.0/qtgui/qmovie.html#isValid" title="QMovie::isValid()">isValid</a>()
para comprobar si el archivo pudo ser abierto y tiene uno de los formatos soportados.</p>
<p>Una alternativa a lo anterior, que nos permite distinguir entre ambos tipos
de error para mostrar al usuario un mensaje diferente según el caso, la tendríamos
usando objetos <a href="http://qt-project.org/doc/qt-5.0/qtcore/qfile.html" title="QFile">QFile</a>. Bastaría con crear dicho objeto usando el nombre del
archivo, abrirlo mediante el método <a href="http://qt-project.org/doc/qt-5.0/qtcore/qfile.html" title="QFile">QFile</a>::<a href="http://qt-project.org/doc/qt-5.0/qtcore/qfile.html#open" title="QFile::open()">open</a>() (esto permite comprobar
si existe y el usuario tiene permisos para abrirlo, pudiendo mostrar un mensaje
de error en caso contrario) y asignarlo al objeto <a href="http://qt-project.org/doc/qt-5.0/qtgui/qmovie.html" title="QMovie">QMovie</a> mediante el método
<a href="http://qt-project.org/doc/qt-5.0/qtgui/qmovie.html" title="QMovie">QMovie</a>::<a href="http://qt-project.org/doc/qt-5.0/qtgui/qmovie.html#setDevice" title="QMovie::setDevice()">setDevice</a>()<sup id="fnref:2"><a class="footnote-ref" href="#fn:2" rel="footnote">2</a></sup>. Entonces podríamos comprobar con el método
<a href="http://qt-project.org/doc/qt-5.0/qtgui/qmovie.html" title="QMovie">QMovie</a>::<a href="http://qt-project.org/doc/qt-5.0/qtgui/qmovie.html#isValid" title="QMovie::isValid()">isValid</a>() si el formato del archivo está entre los soportados.</p>
</li>
</ol>
<h2>Redimensionado de QLabel</h2>
<h2>Mostrando la imagen frame a frame</h2>
<div class="footnote">
<hr />
<ol>
<li id="fn:1">
<p>Sin olvidarnos de que es necesario para liberar la memoria en el destructor de la clase <code>MovieViewerWindow</code>.&#160;<a class="footnote-backref" href="#fnref:1" rev="footnote" title="Jump back to footnote 1 in the text">&#8617;</a></p>
</li>
<li id="fn:2">
<p>Este método permite asignar a una instancia de <a href="http://qt-project.org/doc/qt-5.0/qtgui/qmovie.html" title="QMovie">QMovie</a> un objeto <a href="http://qt-project.org/doc/qt-5.0/qtcore/qiodevice.html" title="QIODevice">QIODevice</a>,
que es la clase base de todos los dispositivos de E/S, incluidos los archivos. Su
misión es proporcionar una interfaz común; mediante métodos como <a href="http://qt-project.org/doc/qt-5.0/qtcore/qfile.html#open" title="QFile::open()">open</a>(),
<code>close()</code>, <code>read()</code>, <code>write()</code>, <code>seek()</code>, etc.; con la que acceder a cualquier
dispositivo. De <a href="http://qt-project.org/doc/qt-5.0/qtcore/qiodevice.html" title="QIODevice">QIODevice</a> heredan clases como <code>QBuffer</code>, <a href="http://qt-project.org/doc/qt-5.0/qtcore/qprocess.html" title="QProcess">QProcess</a> o <a href="http://qt-project.org/doc/qt-5.0/qtcore/qfile.html" title="QFile">QFile</a> que
proporcionan implementaciones concretas para cada tipo de dispositivo en particular.&#160;<a class="footnote-backref" href="#fnref:2" rev="footnote" title="Jump back to footnote 2 in the text">&#8617;</a></p>
</li>
</ol>
</div></div>
        <hr />
    </div>
		
    
 
        

 

    <div class='article'>
        <a href="./proyecto-qt-framework-de-desarrollo-de-aplicaciones.html"><h2>Proyecto Qt. Framework de desarrollo de aplicaciones</h2></a>
        <div class= "well small"> mar 29 enero 2013

by <a class="url fn" href="./author/jesus-torres.html" rel="author">Jesús Torres</a>
 


 </div>
        <div class="summary"><p><a href="http://qt-project.org/" title="Qt Proyect">Qt</a> es una <em>framework</em> multiplataforma en C++ de desarrollo de aplicaciones. Se
utiliza fundamentalmente para desarrollar aplicaciones con interfaz gráfica,
gracias al conjunto de controles independientes de la plataforma que ofrece,
aunque también es usado para crear herramientas de linea de comando o consolas
de gestión para servicios.</p>
<p>Esto último ...</p> <a class="btn btn-info xsmall" href="./proyecto-qt-framework-de-desarrollo-de-aplicaciones.html">leer más</a></div>
    </div>	
				
    
 
        

 

    <div class='article'>
        <a href="./crea-tu-propia-distro-de-linux-con-yocto.html"><h2>Crea tu propia distro de Linux con Yocto</h2></a>
        <div class= "well small"> mar 22 enero 2013

by <a class="url fn" href="./author/jesus-torres.html" rel="author">Jesús Torres</a>
 


 </div>
        <div class="summary"><p>El objetivo de este artículo es explicar paso a paso como se puede utilizar
el proyecto <a href="./yocto-poky-y-bitbake.html" title="Yocto, Poky y BitBake">Yocto</a> para crear nuestra propia distribución de Linux. Primero
construiremos una para ejecutarla en <a href="http://wiki.qemu.org/" title="QEMU">QEMU</a> y después otra para nuestra
Raspberry Pi.</p>
<h2>Inicio rápido</h2>
<p>El inicio rápido con el proyecto <a href="./yocto-poky-y-bitbake.html" title="Yocto, Poky y BitBake">Yocto</a> está perfectamente documentado ...</p> <a class="btn btn-info xsmall" href="./crea-tu-propia-distro-de-linux-con-yocto.html">leer más</a></div>
    </div>	
				
            <div class="pagination">
<ul>
    <li class="prev disabled"><a href="#">&larr; Anterior</a></li>

    <li class="active"><a href="./index.html">1</a></li>
    <li class=""><a href="./index2.html">2</a></li>
    <li class=""><a href="./index3.html">3</a></li>

    <li class="next"><a href="./index2.html">Next &rarr;</a></li>

</ul>
</div>    
 
  
        </div>
        
        <div class="span3">

            
            <div class="well" style="padding: 8px 0; background-color: #FBFBFB;">
            <ul class="nav nav-list">
                <li class="nav-header"> 
                Sitio
                </li>
            
                <li><a href="./archives.html">Archivos</a>
                <li><a href="./tags.html">Etiquetas</a>
                <li><a href="http://ull-etsii-sistemas-operativos.github.com/videovigilancia-blog/feeds/atom.xml" rel="alternate">Fuente Atom</a></li>
                                <li><a href="http://ull-etsii-sistemas-operativos.github.com/videovigilancia-blog/feeds/rss.xml" rel="alternate">Fuente RSS</a></li>
                            </ul>
            </div>


                        <div class="well" style="padding: 8px 0; background-color: #FBFBFB;">
            <ul class="nav nav-list">
                <li class="nav-header"> 
                Categorias
                </li>
                
                                <li><a href="./category/hardware.html">Hardware</a></li>
                                <li><a href="./category/linux.html">Linux</a></li>
                                <li><a href="./category/overviews.html">Overviews</a></li>
                                <li><a href="./category/qt.html">Qt</a></li>
                                   
            </ul>
            </div>
            

            

                        <div class="social">
            <div class="well" style="padding: 8px 0; background-color: #FBFBFB;">
            <ul class="nav nav-list">
                <li class="nav-header"> 
                Social
                </li>
           
                                <li><a href="http://github.com/ull-etsii-sistemas-operativos/">github</a></li>
                                <li><a href="http://plus.google.com/u/0/communities/112085352199958768374">google+</a></li>
                                <li><a href="http://ull-etsii-sistemas-operativos.github.com/videovigilancia-blog/feeds/atom.xml">atom</a></li>
                                <li><a href="http://ull-etsii-sistemas-operativos.github.com/videovigilancia-blog/feeds/rss.xml">rss</a></li>
                            </ul>
            </div>
            </div>
            

            <div class="well" style="padding: 8px 0; background-color: #FBFBFB;">
<ul class="nav nav-list">
    <li class="nav-header">
    Búsqueda de Google
    </li>

    <script type="text/javascript">
    (function() {
    var gcse = document.createElement('script'); gcse.type = 'text/javascript'; gcse.async = true;
    gcse.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') +
        '//www.google.es/cse/cse.js?cx=' + '013894742475483232300:q2-5a1zlira';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(gcse, s);
    })();
    </script>
    <gcse:search>Cargando...</gcse:search>
</ul>
</div>

        </div>  
    </div>     </div> 
<footer>
<br />
<p><a rel="license" href="http://creativecommons.org/licenses/by/3.0/deed.es"><img alt="Licencia Creative Commons" style="border-width:0" src="http://i.creativecommons.org/l/by/3.0/80x15.png" /></a><br />Este obra está bajo una <a rel="license" href="http://creativecommons.org/licenses/by/3.0/deed.es">Licencia Creative Commons Atribución 3.0 Unported</a>.</p>
</footer>

</div> <!-- /container -->
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
<script src="http://twitter.github.com/bootstrap/assets/js/bootstrap-collapse.js"></script>
 
</body>
</html>